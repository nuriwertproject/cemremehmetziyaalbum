<!-- HTML ve Stil bölümü aynı kalabilir -->

<form id="memoryForm">
  <input type="text" id="name" placeholder="Adınız Soyadınız" required />
  <textarea id="message" rows="3" placeholder="Mesajınız..." required></textarea>
  <input type="file" id="photo" accept="image/*" required />
  <button type="submit">Gönder</button>
</form>

<div class="gallery" id="gallery"></div>

<script>
  const form = document.getElementById("memoryForm");
  const gallery = document.getElementById("gallery");

  form.addEventListener("submit", async function (e) {
    e.preventDefault();

    const name = document.getElementById("name").value;
    const message = document.getElementById("message").value;
    const file = document.getElementById("photo").files[0];

    const formData = new FormData();
    formData.append("name", name);
    formData.append("message", message);
    formData.append("photo", file);

    try {
      const response = await fetch("http://VDS_IP:3000/upload", {
        method: "POST",
        body: formData,
      });

      const result = await response.json();
      if (result.success) {
        const photoUrl = `http://VDS_IP:3000/uploads/${result.filename}`;

        const div = document.createElement("div");
        div.className = "entry";
        div.innerHTML = `
          <img src="${photoUrl}" alt="Fotoğraf" />
          <h3>${name}</h3>
          <p>${message}</p>
          <a href="${photoUrl}" target="_blank">Fotoğrafı Gör</a>
        `;
        gallery.prepend(div);
        form.reset();
      } else {
        alert("Fotoğraf yüklenirken bir hata oluştu.");
      }
    } catch (err) {
      console.error(err);
      alert("Sunucuya bağlanılamadı.");
    }
  });
</script>
